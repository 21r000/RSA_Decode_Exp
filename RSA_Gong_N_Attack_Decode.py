from Crypto.Util.number import *
import gmpy2

n = 14392296696053902819727977679854480925933593789847215903786826766554710411210435435677347788801649642535524006141379813657112865299319581948016678234568210213703441080419940477249959466836462723152194401982000850449477317160743416422290465654789750489383440956281075698647797038258588257980968011900465744695193737676672496304908371087767702001172076348419964717266032536421694764166184099932901577532324845077734422277247196824808296097482299137810525971049636934984759467977879112736031931808603239081457298793281678719919112065790396647204436789321508640108037172313028215293127073380938769930444192592421163110149
e1 = 2333
e2 = 23333
c1 = 11613479665764867644320044870647605350176340987094549119730732931178605620012527339943870049250930434799663855270265308838636845426625275544938806955447434287015357327416080351787773563844775336795586501444792419172975844710380414799051684171996717063008680211605235203237751961245305349706457060347680392963496429068752279606725623928679507357937965561275178643856369699631461709747001439374726486105972712270688326602745292592388807612711601237249824361714000598697566505433403161987895753113523446092149380811074593621617069576823403427251654882106426076054352397922522421201441497890387408892403216123167317155732
c2 = 11296842626320429955335118158246832419676126257545034792983513779141257923633031076360364811364886580524857405571611415019050995986701881852250292669669648633071531446579992840040652269835646838273245256991933652913344434121995885472548644691701248807872469235040715725920269468238493298322363197846072428880724469097896957373804324121102269549471897009322964996743541981696483692131977893780309791287473353384655345907218000490590207744275387752914442069357088342262513882962525037011061075609556888270404301063391370287557438517816696205507298836610543523757967955787321176696495661077022473603264936026796023668682


# 共模解密
def Rsa_Gong_N_Attack(n, e1, e2, c1, c2):
    n, e1, e2, c1, c2 = int(n), int(e1), int(e2), int(c1), int(c2)
    s = gmpy2.gcdext(e1, e2)
    s1 = s[1]
    s2 = s[2]
    # 求模反元素
    if s1 < 0:
        s1 = -s1
        c1 = gmpy2.invert(c1, n)
    elif s2 < 0:
        s2 = -s2
        c2 = gmpy2.invert(c2, n)
    m = (pow(c1, s1, n) * pow(c2, s2, n)) % n
    return int(m)


m = Rsa_Gong_N_Attack(n, e1, e2, c1, c2)
print(m)
print(long_to_bytes(m))
